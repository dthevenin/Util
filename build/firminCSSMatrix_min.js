(function(){var h=function(a){this.m11=this.m22=this.m33=this.m44=1;this.m12=this.m13=this.m14=this.m21=this.m23=this.m24=this.m31=this.m32=this.m34=this.m41=this.m42=this.m43=0;"string"==typeof a&&this.setMatrixValue(a)};h.displayName="FirminCSSMatrix";h.degreesToRadians=function(a){return a*Math.PI/180};h.determinant2x2=function(a,b,c,d){return a*d-b*c};h.determinant3x3=function(a,b,c,d,e,f,g,i,j){var k=h.determinant2x2;return a*k(e,f,i,j)-d*k(b,c,i,j)+g*k(b,c,e,f)};h.determinant4x4=function(a){var b=
h.determinant3x3,c=a.m21,d=a.m31,e=a.m41,f=a.m12,g=a.m22,i=a.m32,j=a.m42,k=a.m13,l=a.m23,m=a.m33,n=a.m43,o=a.m14,p=a.m24,q=a.m34,r=a.m44;return a.m11*b(g,l,p,i,m,q,j,n,r)-c*b(f,k,o,i,m,q,j,n,r)+d*b(f,k,o,g,l,p,j,n,r)-e*b(f,k,o,g,l,p,i,m,q)};[["m11","a"],["m12","b"],["m21","c"],["m22","d"],["m41","e"],["m42","f"]].forEach(function(a){var b=a[0];Object.defineProperty(h.prototype,a[1],{set:function(a){this[b]=a},get:function(){return this[b]}})});h.prototype.isAffine=function(){return 0===this.m13&&
0===this.m14&&0===this.m23&&0===this.m24&&0===this.m31&&0===this.m32&&1===this.m33&&0===this.m34&&0===this.m43&&1===this.m44};h.prototype.multiply=function(a){var b=new h;b.m11=a.m11*this.m11+a.m12*this.m21+a.m13*this.m31+a.m14*this.m41;b.m12=a.m11*this.m12+a.m12*this.m22+a.m13*this.m32+a.m14*this.m42;b.m13=a.m11*this.m13+a.m12*this.m23+a.m13*this.m33+a.m14*this.m43;b.m14=a.m11*this.m14+a.m12*this.m24+a.m13*this.m34+a.m14*this.m44;b.m21=a.m21*this.m11+a.m22*this.m21+a.m23*this.m31+a.m24*this.m41;
b.m22=a.m21*this.m12+a.m22*this.m22+a.m23*this.m32+a.m24*this.m42;b.m23=a.m21*this.m13+a.m22*this.m23+a.m23*this.m33+a.m24*this.m43;b.m24=a.m21*this.m14+a.m22*this.m24+a.m23*this.m34+a.m24*this.m44;b.m31=a.m31*this.m11+a.m32*this.m21+a.m33*this.m31+a.m34*this.m41;b.m32=a.m31*this.m12+a.m32*this.m22+a.m33*this.m32+a.m34*this.m42;b.m33=a.m31*this.m13+a.m32*this.m23+a.m33*this.m33+a.m34*this.m43;b.m34=a.m31*this.m14+a.m32*this.m24+a.m33*this.m34+a.m34*this.m44;b.m41=a.m41*this.m11+a.m42*this.m21+a.m43*
this.m31+a.m44*this.m41;b.m42=a.m41*this.m12+a.m42*this.m22+a.m43*this.m32+a.m44*this.m42;b.m43=a.m41*this.m13+a.m42*this.m23+a.m43*this.m33+a.m44*this.m43;b.m44=a.m41*this.m14+a.m42*this.m24+a.m43*this.m34+a.m44*this.m44;return b};h.prototype.isIdentityOrTranslation=function(){return 1===this.m11&&0===this.m12&&0===this.m13&&0===this.m14&&0===this.m21&&1===this.m22&&0===this.m23&&0===this.m24&&0===this.m31&&0===this.m31&&1===this.m33&&0===this.m34&&1===this.m44};h.prototype.adjoint=function(){var a=
new h,b=h.determinant3x3,c=this.m11,d=this.m12,e=this.m13,f=this.m14,g=this.m21,i=this.m22,j=this.m23,k=this.m24,l=this.m31,m=this.m32,n=this.m33,o=this.m34,p=this.m41,q=this.m42,r=this.m43,s=this.m44;a.m11=b(i,m,q,j,n,r,k,o,s);a.m21=-b(g,l,p,j,n,r,k,o,s);a.m31=b(g,l,p,i,m,q,k,o,s);a.m41=-b(g,l,p,i,m,q,j,n,r);a.m12=-b(d,m,q,e,n,r,f,o,s);a.m22=b(c,l,p,e,n,r,f,o,s);a.m32=-b(c,l,p,d,m,q,f,o,s);a.m42=b(c,l,p,d,m,q,e,n,r);a.m13=b(d,i,q,e,j,r,f,k,s);a.m23=-b(c,g,p,e,j,r,f,k,s);a.m33=b(c,g,p,d,i,q,f,k,s);
a.m43=-b(c,g,p,d,i,q,e,j,r);a.m14=-b(d,i,m,e,j,n,f,k,o);a.m24=b(c,g,l,e,j,n,f,k,o);a.m34=-b(c,g,l,d,i,m,f,k,o);a.m44=b(c,g,l,d,i,m,e,j,n);return a};h.prototype.inverse=function(){var a,b,c,d;if(this.isIdentityOrTranslation())return a=new h,0===this.m41&&0===this.m42&&0===this.m43||(a.m41=-this.m41,a.m42=-this.m42,a.m43=-this.m43),a;b=this.adjoint();a=h.determinant4x4(this);if(1.0E-8>Math.abs(a))return null;for(c=1;5>c;c++)for(d=1;5>d;d++)b["m"+c+d]/=a;return b};h.prototype.rotate=function(a,b,c){var d=
h.degreesToRadians;if("number"!=typeof a||isNaN(a))a=0;if(("number"!=typeof b||isNaN(b))&&("number"!=typeof c||isNaN(c)))c=a,b=a=0;if("number"!=typeof b||isNaN(b))b=0;if("number"!=typeof c||isNaN(c))c=0;var a=d(a),b=d(b),c=d(c),d=new h,e=new h,f=new h,g,c=c/2;g=Math.sin(c);c=Math.cos(c);f.m11=f.m22=1-2*g*g;f.m12=f.m21=2*g*c;f.m21*=-1;b/=2;g=Math.sin(b);c=Math.cos(b);e.m11=e.m33=1-2*g*g;e.m13=e.m31=2*g*c;e.m13*=-1;a/=2;g=Math.sin(a);c=Math.cos(a);d.m22=d.m33=1-2*g*g;d.m23=d.m32=2*g*c;d.m32*=-1;return f.multiply(e).multiply(d).multiply(this)};
h.prototype.rotateAxisAngle=function(a,b,c,d){if("number"!=typeof a||isNaN(a))a=0;if("number"!=typeof b||isNaN(b))b=0;if("number"!=typeof c||isNaN(c))c=0;if("number"!=typeof d||isNaN(d))d=0;0===a&&0===b&&0===c&&(c=1);var e=new h,f=Math.sqrt(a*a+b*b+c*c),g,i,j,d=(h.degreesToRadians(d)||0)/2;g=Math.cos(d);i=Math.sin(d);d=i*i;0===f?(b=a=0,c=1):1!==f&&(a/=f,b/=f,c/=f);1===a&&0===b&&0===c?(e.m22=e.m33=1-2*d,e.m23=e.m32=2*g*i,e.m32*=-1):0===a&&1===b&&0===c?(e.m11=e.m33=1-2*d,e.m13=e.m31=2*g*i,e.m13*=-1):
0===a&&0===b&&1===c?(e.m11=e.m22=1-2*d,e.m12=e.m21=2*g*i,e.m21*=-1):(f=i*g,g=a*a,i=b*b,j=c*c,e.m11=1-2*(i+j)*d,e.m12=2*(a*b*d+c*f),e.m13=2*(a*c*d-b*f),e.m21=2*(b*a*d-c*f),e.m22=1-2*(j+g)*d,e.m23=2*(b*c*d+a*f),e.m31=2*(c*a*d+b*f),e.m32=2*(c*b*d-a*f),e.m33=1-2*(g+i)*d);return this.multiply(e)};h.prototype.scale=function(a,b,c){var d=new h;if("number"!=typeof a||isNaN(a))a=1;if("number"!=typeof b||isNaN(b))b=a;if("number"!=typeof c||isNaN(c))c=1;d.m11=a;d.m22=b;d.m33=c;return this.multiply(d)};h.prototype.translate=
function(a,b,c){var d=new h;if("number"!=typeof a||isNaN(a))a=0;if("number"!=typeof b||isNaN(b))b=0;if("number"!=typeof c||isNaN(c))c=0;d.m41=a;d.m42=b;d.m43=c;return this.multiply(d)};h.prototype.setMatrixValue=function(a){var a=a.trim(),b=a.match(/^matrix(3d)?\(\s*(.+)\s*\)$/),c,d,e,f;if(b&&(a=!!b[1],b=b[2].split(/\s*,\s*/),c=b.length,d=Array(c),!(a&&16!==c)&&(a||6===c))){for(e=0;e<c;e++)if(f=b[e],f.match(/^-?\d+(\.\d+)?$/))d[e]=parseFloat(f);else return;for(e=0;e<c;e++)point=a?"m"+(Math.floor(e/
4)+1)+(e%4+1):String.fromCharCode(e+97),this[point]=d[e]}};h.prototype.toString=function(){var a=this,b,c;this.isAffine()?(c="matrix(",b="a,b,c,d,e,f".split(",")):(c="matrix3d(",b="m11,m12,m13,m14,m21,m22,m23,m24,m31,m32,m33,m34,m41,m42,m43,m44".split(","));return c+b.map(function(b){return a[b].toFixed(6)}).join(", ")+")"};this.FirminCSSMatrix=h}).call(this);
